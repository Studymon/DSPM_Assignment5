---
title: "DS400: Assignment V (R)"
author: "Simon Andres (Student ID: 4148078)"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  html_document:
    self_contained: true
---

```{r setup, include = F}
options(scipen=999)
```

***

### GitHub repository

(1) - (4) The GitHub setup was done, all steps of this project are documented in my repository, follow this link: https://github.com/Studymon/DSPM_Assignment5


***

### Getting to know the API

<div class="alert alert-block alert-info">
5. Visit the documentation website for the API provided by ticketmaster.com. Familiarize yourself
with the features and functionalities of the Ticketmaster *Discovery* API. Have a particular look at
rate limits.
</div>

I made myself familiar with the Ticketmaster Discovery API and understand that there is a rate limit of max. 5 requests per second and a maximum number of daily requests of 5000.


<div class="alert alert-block alert-info">
6. Within the scope of this assignment, you do **not** have to request your own API key. Instead retrieve
a valid key from the API Explorer. This API key enables you to perform the `GET` requests needed
throughout this assignment. Even though this API key is not secret per se (it is publicly visible on the
API Explorer website), please comply to the common secrecy practices discussed in the lecture and the
tutorial: Treat the API key as a **secret** token. Your API key should neither appear in the code that you
are submitting nor in your public GitHub repository.
</div>

To comply with the common secrecy practices, the key was stored in a separate script that is stored in a subfolder `api_keys` excluded from syncing with the GitHub repository through the .gitignore file.

```{r, warning = FALSE, message = FALSE}
# Preparation
rm(list = ls())

# Libraries
library(jsonlite)
library(httr)
library(rlist)
library(tidyverse)
```

```{r}
# source the ticketmaster key from separate script
source("./api_keys/tm_key.R")
```

***

### Interacting with the API - the basics

<div class="alert alert-block alert-info">
7. Perform a first `GET` request, that searches for event venues in Germany (`countryCode = "DE"`). Extract
the `content` from the `response` object and inspect the resulting list. Describe what you can see.
</div>

```{r}
# make request
firstVenues <- GET("https://app.ticketmaster.com/discovery/v2/venues.json?",
                     query = list(
                        apikey = tm_key,
                       "countryCode" = "DE",
                       "locale" = "*")
                   )

# make unicode readable
firstVenues <- content(firstVenues)

# the first 20 results (first page) are stored in the "venues" list within the
# "_embedded" list of the content
summary(firstVenues)
```

Our request from the ticketmaster API contains three lists: `_embedded`, `_links`, and `page`

```{r}
# first, we'll look at the page structure
firstVenues[["page"]]
```

We see that for our request there is a total of 12934 elements. However, our specific request only yields the first 20 results, as that is the default number of search results per page for the ticketmaster API. Thus, there are 647 pages in total. The first page index is zero.

```{r}
summary(firstVenues[["_embedded"]])
```

We see that the list `_embedded` contains the list `venues`, which contains information about a total of 20 venues as expected

```{r}
# looking at what information we get on the first element
str(firstVenues[["_embedded"]][["venues"]][[1]])
```

We see that for the first result, we get information on multiple properties of the venue: Name, type, ID, ...
Some of this information is stored in strings, some of it is stored in further sublists.


<div class="alert alert-block alert-info">
8. Extract the `name`, the `city`, the `postalCode` and `address`, as well as the `url` and the `longitude`
and `latitude` of the venues to a data frame.
</div>

```{r}

```

***

### Interacting with the API - advanced

<div class="alert alert-block alert-info">
9. 
</div>

```{r}

```

***

### Visualizing the extracted data

<div class="alert alert-block alert-info">
10. 
</div>

```{r}

```

***

### Event locations in other countries

<div class="alert alert-block alert-info">
12. Repeat exercises (9) - (11) for another European country of your choice.
</div>

```{r}

```
